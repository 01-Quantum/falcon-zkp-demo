<div class="proof-verification-container">
  <div class="info-box">
    <strong>‚ÑπÔ∏è About Verification:</strong> Verify Zero-Knowledge Proofs (Groth16) for Falcon-512 signatures.
    This ensures the proof is valid without revealing the underlying signature data.
  </div>

  <!-- 1. Actions Section -->
  <div class="form-section">
    <h2>1Ô∏è‚É£ Verification Actions</h2>

    <div class="button-group left" style="margin-bottom: 20px;">
      <button class="btn btn-secondary" (click)="goBack()">
        ‚Üê Back to Generator
      </button>
      <button class="btn btn-secondary" (click)="loadExampleProof()">
        Load Example Proof
      </button>
      <button class="btn btn-secondary" (click)="toggleMode()">
        {{ manualMode ? 'Switch to View Mode' : 'Switch to Edit Mode (Tamper)' }}
      </button>
    </div>

    <!-- Manual Input Mode -->
    <div *ngIf="manualMode" class="manual-input-group">
      <h3>Manual Proof Input</h3>
      <div class="form-group">
        <label for="proofInput">Proof JSON</label>
        <textarea id="proofInput" [(ngModel)]="proofInput" rows="8" class="code-font"
          placeholder='{"pi_a": [...], "pi_b": [...], "pi_c": [...], "protocol": "groth16", "curve": "bn128"}'
          [disabled]="loading"></textarea>
      </div>

      <div class="form-group">
        <label for="publicSignalsInput">Public Signals JSON</label>
        <textarea id="publicSignalsInput" [(ngModel)]="publicSignalsInput" rows="4" class="code-font"
          placeholder='["signal1", "signal2", "signal3"]' [disabled]="loading"></textarea>
      </div>

      <div class="button-group center" style="margin-top: 20px;">
        <button type="button" class="btn btn-primary" (click)="verifyProof()" [disabled]="loading">
          <span *ngIf="!loading">üîç Verify Proof Now</span>
          <span *ngIf="loading">‚è≥ Verifying...</span>
        </button>
        <button type="button" class="btn btn-primary" (click)="unlockAccount()" [disabled]="loading"
          style="margin-left: 15px;">
          üîì Unlock Account
        </button>
      </div>
    </div>
  </div>

  <!-- 2. Proof Details Section -->
  <div class="results-section" *ngIf="!manualMode && proof">
    <h2>2Ô∏è‚É£ Proof Details</h2>

    <div class="result-grid">
      <!-- Public Signals -->
      <div class="result-item highlight">
        <div class="label-row">
          <label>Public Signals ({{ publicSignals.length }})</label>
          <button class="btn-copy-inline"
            (click)="copyToClipboard(JSON.stringify(publicSignals), 'Public Signals')">‚ùê</button>
        </div>
        <div class="value-box code-font" style="max-height: 200px; overflow-y: auto;">
          <div *ngFor="let signal of publicSignals; let i = index">
            <strong>[{{i}}]:</strong> {{ signal }}
          </div>
        </div>
      </div>

      <!-- Proof Data -->
      <div class="result-item">
        <div class="label-row">
          <label>Proof Data (œÄ_a, œÄ_b, œÄ_c)</label>
          <button class="btn-copy-inline" (click)="copyToClipboard(JSON.stringify(proof, null, 2), 'Proof')">‚ùê</button>
        </div>
        <div class="value-box code-font" style="max-height: 200px; overflow-y: auto;">
          <div><strong>Protocol:</strong> {{ proof?.protocol }}</div>
          <div><strong>Curve:</strong> {{ proof?.curve }}</div>
          <div style="margin-top: 5px;"><strong>œÄ_a:</strong> {{ proof?.pi_a | json }}</div>
        </div>
      </div>
    </div>

    <div class="button-group center" style="margin-top: 20px;">
      <button type="button" class="btn btn-primary" (click)="verifyProof()" [disabled]="loading">
        <span *ngIf="!loading">üîç Verify Proof Now</span>
        <span *ngIf="loading">‚è≥ Verifying...</span>
      </button>
      <button type="button" class="btn btn-primary" (click)="unlockAccount()" [disabled]="loading"
        style="margin-left: 15px;">
        üîì Unlock Account
      </button>
    </div>
  </div>

  <!-- 3. Results Section -->
  <div class="results-section" *ngIf="verificationResult !== null">
    <h2>3Ô∏è‚É£ Verification Result</h2>

    <div class="result-box" [class.success]="verificationResult" [class.failure]="!verificationResult">
      <div class="result-icon">
        {{ verificationResult ? '‚úÖ' : '‚ùå' }}
      </div>
      <div class="result-text">
        <h3>{{ verificationResult ? 'Proof Valid!' : 'Proof Invalid' }}</h3>
        <p *ngIf="verificationResult">
          The zero-knowledge proof has been successfully verified against the verification key.
          The public inputs are authentic and the proof is cryptographically valid.
        </p>
        <div *ngIf="!verificationResult">
          <p>The proof verification failed. This could mean:</p>
          <ul>
            <li>The proof was tampered with</li>
            <li>The public signals don't match the proof</li>
            <li>The verification key doesn't match the proving key</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="button-group center">
      <button type="button" class="btn btn-secondary" (click)="clearResults()" [disabled]="loading">
        Clear Results
      </button>
    </div>
  </div>

  <div class="info-box" *ngIf="loading">
    <p>üîê Verifying proof against verification key...</p>
  </div>

  <div class="error-message" *ngIf="error">
    <strong>‚ùå Error:</strong> {{ error }}
  </div>

</div>