<div class="container">
  <div class="header">
    <h1>‚úÖ Proof Verification</h1>
    <p class="subtitle">Verify Zero-Knowledge Proofs Against Verification Key</p>
  </div>

  <div class="card">
    <div class="action-buttons">
      <button class="btn btn-secondary" (click)="goBack()">
        ‚Üê Back to Generator
      </button>
      <button class="btn btn-secondary" (click)="loadExampleProof()">
        Load Example Proof
      </button>
      <button class="btn btn-outline" (click)="toggleMode()">
        {{ manualMode ? 'View Mode' : 'Edit Mode (Tamper)' }}
      </button>
    </div>

    <!-- Display Mode -->
    <div *ngIf="!manualMode && proof" class="proof-display">
      <div class="section">
        <h3>Public Signals (Inputs)</h3>
        <div class="public-signals-grid">
          <div class="signal-item" *ngFor="let signal of publicSignals; let i = index">
            <strong>Signal {{ i }}:</strong>
            <code>{{ signal }}</code>
          </div>
        </div>
        <button 
          class="btn-copy" 
          (click)="copyToClipboard(JSON.stringify(publicSignals), 'Public Signals')"
        >
          üìã Copy
        </button>
      </div>

      <div class="section">
        <h3>Proof Data</h3>
        <div class="proof-data">
          <div class="proof-section">
            <strong>œÄ_a:</strong>
            <pre>{{ proof?.pi_a | json }}</pre>
          </div>
          <div class="proof-section">
            <strong>œÄ_b:</strong>
            <pre>{{ proof?.pi_b | json }}</pre>
          </div>
          <div class="proof-section">
            <strong>œÄ_c:</strong>
            <pre>{{ proof?.pi_c | json }}</pre>
          </div>
          <div class="proof-section">
            <strong>Protocol:</strong>
            <code>{{ proof?.protocol }}</code>
          </div>
          <div class="proof-section">
            <strong>Curve:</strong>
            <code>{{ proof?.curve }}</code>
          </div>
        </div>
        <button 
          class="btn-copy" 
          (click)="copyToClipboard(JSON.stringify(proof, null, 2), 'Proof')"
        >
          üìã Copy
        </button>
      </div>
    </div>

    <!-- Manual Input Mode -->
    <div *ngIf="manualMode" class="manual-input">
      <div class="form-group">
        <label for="proofInput">Proof JSON</label>
        <textarea
          id="proofInput"
          [(ngModel)]="proofInput"
          rows="12"
          placeholder='{"pi_a": [...], "pi_b": [...], "pi_c": [...], "protocol": "groth16", "curve": "bn128"}'
          [disabled]="loading"
        ></textarea>
      </div>

      <div class="form-group">
        <label for="publicSignalsInput">Public Signals JSON</label>
        <textarea
          id="publicSignalsInput"
          [(ngModel)]="publicSignalsInput"
          rows="6"
          placeholder='["signal1", "signal2", "signal3"]'
          [disabled]="loading"
        ></textarea>
      </div>
    </div>

    <!-- Verification Results -->
    <div *ngIf="verificationResult !== null" class="result-box" [class.success]="verificationResult" [class.failure]="!verificationResult">
      <div class="result-icon">
        {{ verificationResult ? '‚úÖ' : '‚ùå' }}
      </div>
      <div class="result-text">
        <h3>{{ verificationResult ? 'Proof Valid!' : 'Proof Invalid' }}</h3>
        <p *ngIf="verificationResult">
          The zero-knowledge proof has been successfully verified against the verification key.
          The public inputs are authentic and the proof is cryptographically valid.
        </p>
        <p *ngIf="!verificationResult">
          The proof verification failed. This could mean:
        </p>
        <ul *ngIf="!verificationResult">
          <li>The proof was tampered with</li>
          <li>The public signals don't match the proof</li>
          <li>The verification key doesn't match the proving key</li>
        </ul>
      </div>
    </div>

    <!-- Error Message -->
    <div class="error-message" *ngIf="error">
      <strong>Error:</strong> {{ error }}
    </div>

    <!-- Action Buttons -->
    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="verifyProof()"
        [disabled]="loading || (!proof && !manualMode)"
      >
        <span *ngIf="!loading">üîç Verify Proof</span>
        <span *ngIf="loading">‚è≥ Verifying...</span>
      </button>
      
      <button 
        type="button" 
        class="btn btn-outline" 
        (click)="clearResults()"
        [disabled]="loading"
        *ngIf="verificationResult !== null"
      >
        Clear Results
      </button>
    </div>

    <div class="info-box" *ngIf="loading">
      <p>üîê Verifying proof against verification key...</p>
    </div>
  </div>

  <!-- Verification Key Info -->
  <div class="card info-card">
    <h3>‚ÑπÔ∏è About Verification</h3>
    <p>
      This verification process uses the Groth16 proving system to verify zero-knowledge proofs
      for Falcon-512 post-quantum signatures. The verification key is loaded from the circuit
      configuration and ensures that the proof is valid without revealing the underlying signature data.
    </p>
    <div class="tech-stack">
      <span class="badge">Groth16</span>
      <span class="badge">bn128</span>
      <span class="badge">Falcon-512</span>
      <span class="badge">snarkjs</span>
    </div>
  </div>
</div>
